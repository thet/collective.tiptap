"use strict";(self.webpackChunk_patternslib_pat_tiptap=self.webpackChunk_patternslib_pat_tiptap||[]).push([[842],{4842:function(t,e,n){n.r(e),n.d(e,{context_menu:function(){return _},context_menu_close:function(){return A}});var r=n(33),i=n(7834),o=(n(5666),n(9269)),a=n.n(o),s=n(1191),c=n(7424),u=n(2799);function p(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){d(o,r,i,a,s,"next",t)}function s(t){d(o,r,i,a,s,"throw",t)}a(void 0)}))}}var h=c.Z.getLogger("pat-tooltip"),v=new u.Z("tooltip");v.addArgument("position-list",[],["tl","tm","tr","rt","rm","rb","br","bm","bl","lb","lm","lt"],!0),v.addArgument("position-policy","auto",["auto","force"]),v.addArgument("trigger","click",["click","hover","none"]),v.addArgument("source","title",["ajax","content","title"]),v.addArgument("ajax-data-type","html",["html","markdown"]),v.addArgument("closing","auto",["auto","sticky","close-button"]),v.addArgument("delay"),v.addArgument("mark-inactive",!0),v.addArgument("class"),v.addArgument("target","body"),v.addArgument("arrow-padding",null),v.addArgument("url",null);var g=s.Z.extend({name:"tooltip",trigger:".pat-tooltip, .pat-tooltip-ng",tippy:null,ajax_state:{isFetching:!1,canFetch:!0},active_class:"tooltip-active-hover",inactive_class:"tooltip-inactive",init:function(){var t=this;return f(regeneratorRuntime.mark((function e(){var r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.el,window.__patternslib_import_styles&&n.e(422).then(n.bind(n,8422)),e.next=4,n.e(861).then(n.bind(n,3861));case 4:i=e.sent.default,t.options=v.parse(r,t.options),t.tippy_options=t.parseOptionsForTippy(t.options),o={animation:!1,arrow:!0,hideOnClick:"close-button"!==t.options.closing,ignoreAttributes:!0,interactive:!0,onHide:t._onHide.bind(t),onShow:t._onShow.bind(t),onMount:t._onMount.bind(t),trigger:"click"},i.setDefaultProps(o),t.tippy=new i(r,t.tippy_options),r.getAttribute("title")&&r.removeAttribute("title"),"click"===t.options.trigger&&"ajax"===t.options.source&&r.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation()})),"click"===t.options.trigger&&(t.active_class="tooltip-active-click"),t.options.markInactive&&r.classList.add(t.inactive_class);case 14:case"end":return e.stop()}}),e)})))()},show:function(){this.tippy.show()},hide:function(){this.tippy.hide()},destroy:function(){this.tippy.destroy()},parseOptionsForTippy:function(t){var e=this,n=function(t){var e;return"".concat((e=t[0],{t:"bottom",r:"left",b:"top",l:"right"}[e])).concat({l:"-start",r:"-end",m:"",t:"-start",b:"-end"}[t[1]])},r={popperOptions:{modifiers:[]}};null!==t.arrowPadding&&r.popperOptions.modifiers.push({name:"arrow",options:{padding:parseInt(t.arrowPadding,10)}});var o={position:function(){var e,i;if(null!==(e=t.position)&&void 0!==e&&null!==(i=e.list)&&void 0!==i&&i.length){r.placement=n(t.position.list[0]);var o={name:"flip",enabled:!0};if("force"===t.position.policy)o.enabled=!1;else if(t.position.length>1){var a=t.position.list.slice(1).map(n);o.fallbackPlacements=a}r.popperOptions.modifiers.push(o)}},trigger:function(){"hover"===t.trigger?r.trigger="mouseenter focus":"none"===t.trigger&&(r.trigger="manual",r.hideOnClick=!1)},source:function(){var n;"title"===t.source?n=e.el.getAttribute("title"):"content"===t.source?(n=e.el.innerHTML,r.allowHTML=!0):"ajax"===t.source&&(n=document.createElement("progress"),r.allowHTML=!0),r.content=n},delay:function(){t.delay&&(r.delay=[i.Z.parseTime(t.delay),0])},target:function(){t.target&&("parent"===t.target?r.appendTo="parent":"body"===t.target?r.appendTo=document.body:r.appendTo=document.querySelector(t.target))}};for(var a in t){switch(a){case"ajax-data-type":a="ajaxDataType";break;case"mark-inactive":a="markInactive"}o[a]&&o[a](a)}return r},_initializeContent:function(){var t,e=this,n=this.tippy.popper.querySelectorAll(".close-panel"),o=this.tippy.popper.querySelectorAll(".pat-tooltip--close-button"),a=p(n);try{for(a.s();!(t=a.n()).done;){t.value.addEventListener("click",f(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.Z.timeout(1);case 2:n=p(o);try{for(n.s();!(r=n.n()).done;)(a=r.value).parentNode.removeChild(a)}catch(t){n.e(t)}finally{n.f()}e.tippy.hide();case 5:case"end":return t.stop()}}),t)}))))}}catch(t){a.e(t)}finally{a.f()}r.Z.scan(this.tippy.popper)},_onMount:function(){var t=this;return f(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ajax"!==t.options.source){e.next=3;break}return e.next=3,t._getContent();case 3:t._initializeContent(),a()(t.tippy.popper).trigger("patterns-injected",[{skipPatInjectHandler:!0},t.el,t.tippy.popper]);case 5:case"end":return e.stop()}}),e)})))()},_onShow:function(){if("auto"!==this.options.closing&&"hover"===this.options.trigger&&this.tippy.setProps({trigger:"click"}),"close-button"===this.options.closing){var t=document.createElement("button");t.setAttribute("class","close-panel pat-tooltip--close-button");var e=this.tippy.popper.querySelector(".tippy-content");e.parentNode.insertBefore(t,e)}if(this.options.markInactive&&(this.el.classList.remove(this.inactive_class),this.el.classList.add(this.active_class)),this.options.class){var n,r=p(this.options.class.split(" "));try{for(r.s();!(n=r.n()).done;){var i=n.value;this.tippy.popper.classList.add(i)}}catch(t){r.e(t)}finally{r.f()}}this.tippy.popper.classList.add("tooltip-container")},_onHide:function(){this.options.markInactive&&(this.el.classList.remove(this.active_class),this.el.classList.add(this.inactive_class)),"auto"!==this.options.closing&&"hover"===this.options.trigger&&this.tippy.setProps({trigger:"mouseenter focus"}),"ajax"===this.options.source&&(this.tippy.setContent(document.createElement("progress")),this.ajax_state.canFetch=!0)},_getContent:function(){var t=this;return f(regeneratorRuntime.mark((function e(){var n,r,o,a,s,c,u,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ajax_state.isFetching&&t.ajax_state.canFetch){e.next=2;break}return e.abrupt("return",void 0);case 2:if(n=t.get_url_parts(t.options.url||t.el.getAttribute("href")),r=n.url,o=n.selector,!r){e.next=24;break}return t.ajax_state={isFetching:!0,canFetch:!1},s=t._ajaxDataTypeHandlers[t.options.ajaxDataType],e.prev=6,e.next=9,fetch(r);case 9:return c=e.sent,e.next=12,c.text();case 12:return u=e.sent,e.next=15,s(u,r,o);case 15:a=e.sent,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),h.error("Error on ajax request ".concat(e.t0));case 21:t.ajax_state.isFetching=!1,e.next=25;break;case 24:o&&(a=document.querySelector(o),a=(null===(p=a)||void 0===p?void 0:p.innerHTML)||void 0);case 25:if(!a){e.next=30;break}return t.tippy.setContent(a),e.next=29,i.Z.timeout(1);case 29:t.tippy.popperInstance.forceUpdate();case 30:case"end":return e.stop()}}),e,null,[[6,18]])})))()},get_url_parts:function(t){var e,n;return t?{url:e=t.split("#")[0]||void 0,selector:n=(n=t.split("#")[1]||void 0)?"#".concat(n):void 0}:{url:e,selector:n}},_ajaxDataTypeHandlers:{html:function(t,e,n){var r,i=document.createElement("div");return i.innerHTML=t,n&&(i=i.querySelector(n)),(null===(r=i)||void 0===r?void 0:r.innerHTML)||""},markdown:function(t,e,r){return f(regeneratorRuntime.mark((function i(){var o,s,c,u;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.e(244).then(n.bind(n,5244));case 2:return o=i.sent,s=o.default.init(a()("<div/>")),c={url:e},r&&(c.source=r),i.next=8,s.renderForInjection(c,t);case 8:return u=i.sent,i.abrupt("return",u[0]);case 10:case"end":return i.stop()}}),i)})))()}}}),m=n(6798);function y(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function b(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){y(o,r,i,a,s,"next",t)}function s(t){y(o,r,i,a,s,"throw",t)}a(void 0)}))}}var x=null,w=null;function _(t,e){return k.apply(this,arguments)}function k(){return k=b(regeneratorRuntime.mark((function t(e,n){var o,a,s,c,u,p,l=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=l.length>2&&void 0!==l[2]?l[2]:null,s=l.length>3&&void 0!==l[3]?l[3]:null,c=l.length>4&&void 0!==l[4]?l[4]:null,u=w,(w=n.state.doc.nodeAt(n.state.selection.from))!==u&&A(s.name),!a||a()){t.next=8;break}return t.abrupt("return");case 8:if(x){t.next=16;break}return s&&(r.Z.patterns[s.name]=s),p=n.options.element,t.next=13,new g(p,{source:"ajax",url:e,trigger:"none",class:c,"position-list":["tm"]});case 13:return x=t.sent,t.next=16,i.Z.timeout(50);case 16:return null===(o=x.tippy)||void 0===o||o.setProps({getReferenceClientRect:function(){return(0,m.posToDOMRect)(n.view,n.state.selection.from,n.state.selection.to)}}),x.show(),t.abrupt("return",x);case 19:case"end":return t.stop()}}),t)}))),k.apply(this,arguments)}function A(t){x&&(x.hide(),x.destroy(),x=null),t&&delete r.Z.patterns[t]}}}]);