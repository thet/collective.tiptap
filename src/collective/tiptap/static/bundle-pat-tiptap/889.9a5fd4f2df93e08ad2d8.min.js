"use strict";(self.webpackChunk_patternslib_pat_tiptap=self.webpackChunk_patternslib_pat_tiptap||[]).push([[889],{9889:function(e,t,a){a.r(t),a.d(t,{CodeBlock:function(){return i},backtickInputRegex:function(){return s},default:function(){return i},tildeInputRegex:function(){return o}});var n=a(6798),r=a(6922);const s=/^```(?<language>[a-z]*)?[\s\n]$/,o=/^~~~(?<language>[a-z]*)?[\s\n]$/,i=n.Node.create({name:"codeBlock",defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:a}=this.options,n=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter((e=>e.startsWith(a))).map((e=>e.replace(a,"")))[0];return n||null},renderHTML:e=>e.language?{class:this.options.languageClassPrefix+e.language}:null}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({HTMLAttributes:e}){return["pre",this.options.HTMLAttributes,["code",e,0]]},addCommands:()=>({setCodeBlock:e=>({commands:t})=>t.setNode("codeBlock",e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode("codeBlock","paragraph",e)}),addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,a=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!a&&t.parent.textContent.length)&&this.editor.commands.clearNodes())}}},addInputRules(){return[(0,n.textblockTypeInputRule)({find:s,type:this.type,getAttributes:({groups:e})=>e}),(0,n.textblockTypeInputRule)({find:o,type:this.type,getAttributes:({groups:e})=>e})]},addProseMirrorPlugins(){return[new r.Sy({key:new r.H$("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const a=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("vscode-editor-data"),s=n?JSON.parse(n):void 0,o=null==s?void 0:s.mode;if(!a||!o)return!1;const{tr:i}=e.state;return i.replaceSelectionWith(this.type.create({language:o})),i.setSelection(r.Bs.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.insertText(a.replace(/\r\n?/g,"\n")),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}})}}]);