"use strict";(self.webpackChunk_patternslib_pat_tiptap=self.webpackChunk_patternslib_pat_tiptap||[]).push([[334],{4334:function(e,t,r){r.r(t),r.d(t,{Gapcursor:function(){return v},default:function(){return v}});var n=r(6798),o=r(2629),i=r(6922),a=r(8780),s=r(8638),l=function(e){function t(t){e.call(this,t,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(r,n){var o=r.resolve(n.map(this.head));return t.valid(o)?new t(o):e.near(o)},t.prototype.content=function(){return s.p2.empty},t.prototype.eq=function(e){return e instanceof t&&e.head==this.head},t.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},t.fromJSON=function(e,r){if("number"!=typeof r.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(e.resolve(r.pos))},t.prototype.getBookmark=function(){return new u(this.anchor)},t.valid=function(e){var t=e.parent;if(t.isTextblock||!function(e){for(var t=e.depth;t>=0;t--){var r=e.index(t);if(0!=r)for(var n=e.node(t).child(r-1);;n=n.lastChild){if(0==n.childCount&&!n.inlineContent||n.isAtom||n.type.spec.isolating)return!0;if(n.inlineContent)return!1}}return!0}(e)||!function(e){for(var t=e.depth;t>=0;t--){var r=e.indexAfter(t),n=e.node(t);if(r!=n.childCount)for(var o=n.child(r);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(e))return!1;var r=t.type.spec.allowGapCursor;if(null!=r)return r;var n=t.contentMatchAt(e.index()).defaultType;return n&&n.isTextblock},t.findFrom=function(e,r,n){e:for(;;){if(!n&&t.valid(e))return e;for(var o=e.pos,a=null,s=e.depth;;s--){var l=e.node(s);if(r>0?e.indexAfter(s)<l.childCount:e.index(s)>0){a=l.child(r>0?e.indexAfter(s):e.index(s)-1);break}if(0==s)return null;o+=r;var u=e.doc.resolve(o);if(t.valid(u))return u}for(;;){var c=r>0?a.firstChild:a.lastChild;if(!c){if(a.isAtom&&!a.isText&&!i.qv.isSelectable(a)){e=e.doc.resolve(o+a.nodeSize*r),n=!1;continue e}break}a=c,o+=r;var p=e.doc.resolve(o);if(t.valid(p))return p}return null}},t}(i.Y1);l.prototype.visible=!1,i.Y1.jsonID("gapcursor",l);var u=function(e){this.pos=e};u.prototype.map=function(e){return new u(e.map(this.pos))},u.prototype.resolve=function(e){var t=e.resolve(this.pos);return l.valid(t)?new l(t):i.Y1.near(t)};var c=(0,o.$)({ArrowLeft:p("horiz",-1),ArrowRight:p("horiz",1),ArrowUp:p("vert",-1),ArrowDown:p("vert",1)});function p(e,t){var r="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,n,o){var a=e.selection,s=t>0?a.$to:a.$from,u=a.empty;if(a instanceof i.Bs){if(!o.endOfTextblock(r)||0==s.depth)return!1;u=!1,s=e.doc.resolve(t>0?s.after():s.before())}var c=l.findFrom(s,t,u);return!!c&&(n&&n(e.tr.setSelection(new l(c))),!0)}}function f(e,t,r){if(!e.editable)return!1;var n=e.state.doc.resolve(t);if(!l.valid(n))return!1;var o=e.posAtCoords({left:r.clientX,top:r.clientY}).inside;return!(o>-1&&i.qv.isSelectable(e.state.doc.nodeAt(o)))&&(e.dispatch(e.state.tr.setSelection(new l(n))),!0)}function d(e){if(!(e.selection instanceof l))return null;var t=document.createElement("div");return t.className="ProseMirror-gapcursor",a.EH.create(e.doc,[a.p.widget(e.selection.head,t,{key:"gapcursor"})])}const v=n.Extension.create({name:"gapCursor",addProseMirrorPlugins:()=>[new i.Sy({props:{decorations:d,createSelectionBetween:function(e,t,r){if(t.pos==r.pos&&l.valid(r))return new l(r)},handleClick:f,handleKeyDown:c}})],extendNodeSchema(e){var t;const r={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!==(t=(0,n.callOrReturn)((0,n.getExtensionField)(e,"allowGapCursor",r)))&&void 0!==t?t:null}}})}}]);